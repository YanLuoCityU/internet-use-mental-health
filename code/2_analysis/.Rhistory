)
) %>%
mutate(subgroup = "drink")
dat_nodrink <- satlife_iyes_adj_mi_nodrink_results %>%
bind_rows(
tibble(
country = "Overall", term = NA, contrast = NA,
estimate = as.numeric(satlife_iyes_adj_mi_nodrink_meta$beta),
std.error = as.numeric(satlife_iyes_adj_mi_nodrink_meta$se),
statistic = NA,
p.value = satlife_iyes_adj_mi_nodrink_meta$pval, p.sig = ifelse(p.value < 0.05, 1, NA)
)
) %>%
mutate(subgroup = "nodrink")
# Physical activity
dat_phyinact <- satlife_iyes_adj_mi_phyinact_results %>%
bind_rows(
tibble(
country = "Poland", term = NA, contrast = NA,
estimate = NA, std.error = NA, statistic = NA, p.value = NA, p.sig = NA
)
) %>%
arrange(country) %>%
bind_rows(
tibble(
country = "Overall", term = NA, contrast = NA,
estimate = as.numeric(satlife_iyes_adj_mi_phyinact_meta$beta),
std.error = as.numeric(satlife_iyes_adj_mi_phyinact_meta$se),
statistic = NA,
p.value = satlife_iyes_adj_mi_phyinact_meta$pval, p.sig = ifelse(p.value < 0.05, 1, NA)
)
) %>%
mutate(subgroup = "phyinact")
dat_phyact <- satlife_iyes_adj_mi_phyact_results %>%
bind_rows(
tibble(
country = "Overall", term = NA, contrast = NA,
estimate = as.numeric(satlife_iyes_adj_mi_phyact_meta$beta),
std.error = as.numeric(satlife_iyes_adj_mi_phyact_meta$se),
statistic = NA,
p.value = satlife_iyes_adj_mi_phyact_meta$pval, p.sig = ifelse(p.value < 0.05, 1, NA)
)
) %>%
mutate(subgroup = "phyact")
# ADL disability
dat_adl <- satlife_iyes_adj_mi_adl_results %>%
bind_rows(
tibble(
country = "Poland", term = NA, contrast = NA,
estimate = NA, std.error = NA, statistic = NA, p.value = NA, p.sig = NA
)
) %>%
arrange(country) %>%
bind_rows(
tibble(
country = "Overall", term = NA, contrast = NA,
estimate = as.numeric(satlife_iyes_adj_mi_adl_meta$beta),
std.error = as.numeric(satlife_iyes_adj_mi_adl_meta$se),
statistic = NA,
p.value = satlife_iyes_adj_mi_adl_meta$pval, p.sig = ifelse(p.value < 0.05, 1, NA)
)
) %>%
mutate(subgroup = "adl")
dat_noadl <- satlife_iyes_adj_mi_noadl_results %>%
bind_rows(
tibble(
country = "Overall", term = NA, contrast = NA,
estimate = as.numeric(satlife_iyes_adj_mi_noadl_meta$beta),
std.error = as.numeric(satlife_iyes_adj_mi_noadl_meta$se),
statistic = NA,
p.value = satlife_iyes_adj_mi_noadl_meta$pval, p.sig = ifelse(p.value < 0.05, 1, NA)
)
) %>%
mutate(subgroup = "noadl")
# Chronic conditions
dat_dis <- satlife_iyes_adj_mi_dis_results %>%
bind_rows(
tibble(
country = "Overall", term = NA, contrast = NA,
estimate = as.numeric(satlife_iyes_adj_mi_dis_meta$beta),
std.error = as.numeric(satlife_iyes_adj_mi_dis_meta$se),
statistic = NA,
p.value = satlife_iyes_adj_mi_dis_meta$pval, p.sig = ifelse(p.value < 0.05, 1, NA)
)
) %>%
mutate(subgroup = "dis")
dat_nodis <- satlife_iyes_adj_mi_nodis_results %>%
bind_rows(
tibble(
country = "Overall", term = NA, contrast = NA,
estimate = as.numeric(satlife_iyes_adj_mi_nodis_meta$beta),
std.error = as.numeric(satlife_iyes_adj_mi_nodis_meta$se),
statistic = NA,
p.value = satlife_iyes_adj_mi_nodis_meta$pval, p.sig = ifelse(p.value < 0.05, 1, NA)
)
) %>%
mutate(subgroup = "nodis")
# Genetic risk: Depressive symptoms PGS
dat_deprepgs_low <- satlife_iyes_adj_mi_deprepgs_re %>%
filter(deprepgs == "low") %>%
select(-deprepgs) %>%
bind_rows(
tibble(
country = c("Austria", "Belgium", "Brazil", "China", "Croatia", "Czech Republic", "Denmark", "Estonia", "France", "Germany", "Greece", "Israel", "Italy", "Luxembourg", "Mexico", "Netherlands", "Poland", "Slovenia", "Spain", "Sweden", "Switzerland"),
term = rep("internet_yesyes", 21), contrast = rep(NA, 21), estimate = rep(NA, 21),
std.error = rep(NA, 21), statistic = rep(NA, 21), p.value = rep(NA, 21), p.sig = rep(NA, 21)
)
) %>%
arrange(country) %>%
bind_rows(
tibble(
country = "Overall", term = NA, contrast = NA,
estimate = NA, std.error = NA, statistic = NA, p.value = NA, p.sig = NA
)
) %>%
mutate(subgroup = "dlow")
dat_deprepgs_interm <- satlife_iyes_adj_mi_deprepgs_re %>%
filter(deprepgs == "intermediate") %>%
select(-deprepgs) %>%
bind_rows(
tibble(
country = c("Austria", "Belgium", "Brazil", "China", "Croatia", "Czech Republic", "Denmark", "Estonia", "France", "Germany", "Greece", "Israel", "Italy", "Luxembourg", "Mexico", "Netherlands", "Poland", "Slovenia", "Spain", "Sweden", "Switzerland"),
term = rep("internet_yesyes", 21), contrast = rep(NA, 21), estimate = rep(NA, 21),
std.error = rep(NA, 21), statistic = rep(NA, 21), p.value = rep(NA, 21), p.sig = rep(NA, 21)
)
) %>%
arrange(country) %>%
bind_rows(
tibble(
country = "Overall", term = NA, contrast = NA,
estimate = NA, std.error = NA, statistic = NA, p.value = NA, p.sig = NA
)
) %>%
mutate(subgroup = "dinterm")
dat_deprepgs_high <- satlife_iyes_adj_mi_deprepgs_re %>%
filter(deprepgs == "high") %>%
select(-deprepgs) %>%
bind_rows(
tibble(
country = c("Austria", "Belgium", "Brazil", "China", "Croatia", "Czech Republic", "Denmark", "Estonia", "France", "Germany", "Greece", "Israel", "Italy", "Luxembourg", "Mexico", "Netherlands", "Poland", "Slovenia", "Spain", "Sweden", "Switzerland"),
term = rep("internet_yesyes", 21), contrast = rep(NA, 21), estimate = rep(NA, 21),
std.error = rep(NA, 21), statistic = rep(NA, 21), p.value = rep(NA, 21), p.sig = rep(NA, 21)
)
) %>%
arrange(country) %>%
bind_rows(
tibble(
country = "Overall", term = NA, contrast = NA,
estimate = NA, std.error = NA, statistic = NA, p.value = NA, p.sig = NA
)
) %>%
mutate(subgroup = "dhigh")
# Genetic risk: Subjective well-being PGS
dat_wellbpgs_low <- satlife_iyes_adj_mi_wellbpgs_re %>%
filter(wellbpgs == "low") %>%
select(-wellbpgs) %>%
bind_rows(
tibble(
country = c("Austria", "Belgium", "Brazil", "China", "Croatia", "Czech Republic", "Denmark", "Estonia", "France", "Germany", "Greece", "Israel", "Italy", "Luxembourg", "Mexico", "Netherlands", "Poland", "Slovenia", "Spain", "Sweden", "Switzerland"),
term = rep("internet_yesyes", 21), contrast = rep(NA, 21), estimate = rep(NA, 21),
std.error = rep(NA, 21), statistic = rep(NA, 21), p.value = rep(NA, 21), p.sig = rep(NA, 21)
)
) %>%
arrange(country) %>%
bind_rows(
tibble(
country = "Overall", term = NA, contrast = NA,
estimate = NA, std.error = NA, statistic = NA, p.value = NA, p.sig = NA
)
) %>%
mutate(subgroup = "wlow")
dat_wellbpgs_interm <- satlife_iyes_adj_mi_wellbpgs_re %>%
filter(wellbpgs == "intermediate") %>%
select(-wellbpgs) %>%
bind_rows(
tibble(
country = c("Austria", "Belgium", "Brazil", "China", "Croatia", "Czech Republic", "Denmark", "Estonia", "France", "Germany", "Greece", "Israel", "Italy", "Luxembourg", "Mexico", "Netherlands", "Poland", "Slovenia", "Spain", "Sweden", "Switzerland"),
term = rep("internet_yesyes", 21), contrast = rep(NA, 21), estimate = rep(NA, 21),
std.error = rep(NA, 21), statistic = rep(NA, 21), p.value = rep(NA, 21), p.sig = rep(NA, 21)
)
) %>%
arrange(country) %>%
bind_rows(
tibble(
country = "Overall", term = NA, contrast = NA,
estimate = NA, std.error = NA, statistic = NA, p.value = NA, p.sig = NA
)
) %>%
mutate(subgroup = "winterm")
dat_wellbpgs_high <- satlife_iyes_adj_mi_wellbpgs_re %>%
filter(wellbpgs == "high") %>%
select(-wellbpgs) %>%
bind_rows(
tibble(
country = c("Austria", "Belgium", "Brazil", "China", "Croatia", "Czech Republic", "Denmark", "Estonia", "France", "Germany", "Greece", "Israel", "Italy", "Luxembourg", "Mexico", "Netherlands", "Poland", "Slovenia", "Spain", "Sweden", "Switzerland"),
term = rep("internet_yesyes", 21), contrast = rep(NA, 21), estimate = rep(NA, 21),
std.error = rep(NA, 21), statistic = rep(NA, 21), p.value = rep(NA, 21), p.sig = rep(NA, 21)
)
) %>%
arrange(country) %>%
bind_rows(
tibble(
country = "Overall", term = NA, contrast = NA,
estimate = NA, std.error = NA, statistic = NA, p.value = NA, p.sig = NA
)
) %>%
mutate(subgroup = "whigh")
dat <- dat_middle %>%
bind_rows(., dat_old) %>%
bind_rows(., dat_male) %>%
bind_rows(., dat_female) %>%
bind_rows(., dat_married) %>%
bind_rows(., dat_nonmarried) %>%
bind_rows(., dat_contact) %>%
bind_rows(., dat_nocontact) %>%
bind_rows(., dat_pedu) %>%
bind_rows(., dat_sedu) %>%
bind_rows(., dat_tedu) %>%
bind_rows(., dat_lwealth) %>%
bind_rows(., dat_mwealth) %>%
bind_rows(., dat_hwealth) %>%
bind_rows(., dat_work) %>%
bind_rows(., dat_retired) %>%
bind_rows(., dat_others) %>%
bind_rows(., dat_smoke) %>%
bind_rows(., dat_nosmoke) %>%
bind_rows(., dat_drink) %>%
bind_rows(., dat_nodrink) %>%
bind_rows(., dat_phyinact) %>%
bind_rows(., dat_phyact) %>%
bind_rows(., dat_adl) %>%
bind_rows(., dat_noadl) %>%
bind_rows(., dat_dis) %>%
bind_rows(., dat_nodis) %>%
bind_rows(., dat_deprepgs_low) %>%
bind_rows(., dat_deprepgs_interm) %>%
bind_rows(., dat_deprepgs_high) %>%
bind_rows(., dat_wellbpgs_low) %>%
bind_rows(., dat_wellbpgs_interm) %>%
bind_rows(., dat_wellbpgs_high) %>%
mutate(
country_italic = ifelse(country == "Overall", glue("***{country}***"), glue("{country}")),
country_italic = factor(country_italic, levels = c("***Overall***", rev(dat_middle$country)[-1])),
subgroup =
factor(
subgroup,
levels = c("middle", "old", "male", "female", "married", "nonmarried", "contact", "nocontact", "pedu", "sedu", "tedu", "lwealth", "mwealth", "hwealth", "work", "retired", "others", "smoke", "nosmoke", "drink", "nodrink", "phyact", "phyinact", "noadl", "adl", "nodis", "dis", "dlow", "dinterm", "dhigh", "wlow", "winterm", "whigh"),
labels = c("50-64 years", "≥65 years", "Male", "Female", "Married", "Unmarried", "Weekly contact", "Less than weekly contact", "Primary", "Secondary", "Tertiary", "Low", "Middle", "High", "Working", "Retired", "Others", "Current smoking", "No smoking", "Weekly alcohol use", "Less than weekly alcohol use", "Physical activity", "Physical inactivity", "No ADL limitation", "ADL disability", "No chronic conditions", "≥1 chronic condition", "Low genetic risk (DS)", "Intermediate genetic risk (DS)", "High genetic risk (DS)", "Low genetic risk (SWB)", "Intermediate genetic risk (SWB)", "High genetic risk (SWB)")
),
estimate_new = case_when(
estimate < -0.5 ~ -0.5,
estimate > 0.5 ~ 0.5,
TRUE ~ estimate
),
estimate_text = sprintf("%0.2f", estimate),
p.sig = ifelse(p.sig == 1, "*", p.sig),
estimate_p.sig = str_c(estimate_text, p.sig),
overall_p.sig = ifelse(country == "Overall", estimate_p.sig, NA)
)
#### Plot ####
rect_satlife <- ggplot(dat, aes(x = subgroup, y = country_italic, fill = estimate_new)) +
# geom_tile(colour = "grey50") +
geom_tile(colour = "black") +
geom_text(
aes(label = overall_p.sig), size = 4, vjust = 0.7,
) +
theme_void() +
theme(
axis.text.x = element_text(size = 12, colour = "black", hjust = 1, vjust = 1, angle = 45),
axis.text.y = element_markdown(size = 12, colour = "black", hjust = 1, vjust = .5, angle = 0),
axis.title.x = element_text(size = 16, vjust = 0, angle = 00, face = "bold"),
axis.title.y = element_text(size = 16, vjust = 1, angle = 90, face = "bold"),
legend.title = element_text(size = 12, hjust = 0.1),
legend.text = element_text(size = 12),
legend.position = "none",
plot.margin = unit(c(t = 0, r = .25, b = .5, l = .25), "cm"),
plot.title = element_text(size = 16, hjust = .5)
) +
scale_fill_gradientn(
colours = c("#58539f", "#bbbbd6", "#FFFFFFFF", "#eebabb", "#d86967"),
limit = c(-0.5, 0.5),
breaks = c(-0.5, -0.25, 0, 0.25, 0.5),
labels = c("≤-0.5", -0.25, 0, 0.25, "≥0.5"),
name = "AME",
na.value = "#DCDCDC"
) +
labs(
x = NULL,
y = NULL,
title = NULL,
labels = "AME"
) +
annotate(geom = "rect", xmin = 0.5, xmax = 2.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#FF9D9AFF") +
annotate(geom = "rect", xmin = 2.5, xmax = 4.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#E15759FF") +
annotate(geom = "rect", xmin = 4.5, xmax = 6.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#A0CBE8FF") +
annotate(geom = "rect", xmin = 6.5, xmax = 8.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#4E79A7FF") +
annotate(geom = "rect", xmin = 8.5, xmax = 11.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#FFBE7DFF") +
annotate(geom = "rect", xmin = 11.5, xmax = 14.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#F28E2BFF") +
annotate(geom = "rect", xmin = 14.5, xmax = 17.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#8CD17DFF") +
annotate(geom = "rect", xmin = 17.5, xmax = 19.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#59A14FFF") +
annotate(geom = "rect", xmin = 19.5, xmax = 21.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#D7B5A6FF") +
annotate(geom = "rect", xmin = 21.5, xmax = 23.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#9D7660FF") +
annotate(geom = "rect", xmin = 23.5, xmax = 25.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#FABFD2FF") +
annotate(geom = "rect", xmin = 25.5, xmax = 27.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#D37295FF") +
annotate(geom = "rect", xmin = 27.5, xmax = 30.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#F1CE63FF") +
annotate(geom = "rect", xmin = 30.5, xmax = 33.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#B6992DFF")
rect_satlife_nopgs <- ggplot(dat %>% filter(!subgroup %in% c("Low genetic risk (DS)", "Intermediate genetic risk (DS)", "High genetic risk (DS)", "Low genetic risk (SWB)", "Intermediate genetic risk (SWB)", "High genetic risk (SWB)")), aes(x = subgroup, y = country_italic, fill = estimate_new)) +
# geom_tile(colour = "grey50") +
geom_tile(colour = "black") +
geom_text(
aes(label = overall_p.sig), size = 4, vjust = 0.7,
) +
theme_void() +
theme(
axis.text.y = element_markdown(size = 12, colour = "black", hjust = 1, vjust = .5, angle = 0),
axis.text.x = element_text(size = 12, colour = "black", hjust = 1, vjust = 1, angle = 45),
axis.title.x = element_text(size = 16, vjust = 0, angle = 00, face = "bold"),
axis.title.y = element_text(size = 16, vjust = 1, angle = 90, face = "bold"),
legend.title = element_text(size = 12, hjust = 0.1),
legend.text = element_text(size = 12),
legend.position = "none",
plot.margin = unit(c(t = 0, r = .25, b = .5, l = .25), "cm"),
plot.title = element_text(size = 16, hjust = .5)
) +
scale_fill_gradientn(
colours = c("#58539f", "#bbbbd6", "#FFFFFFFF", "#eebabb", "#d86967"),
limit = c(-0.5, 0.5),
breaks = c(-0.5, -0.25, 0, 0.25, 0.5),
labels = c("≤-0.5", -0.25, 0, 0.25, "≥0.5"),
name = "AME",
na.value = "#DCDCDC"
) +
labs(
x = NULL,
y = NULL,
title = NULL,
labels = "AME"
) +
annotate(geom = "rect", xmin = 0.5, xmax = 2.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#FF9D9AFF") +
annotate(geom = "rect", xmin = 2.5, xmax = 4.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#E15759FF") +
annotate(geom = "rect", xmin = 4.5, xmax = 6.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#A0CBE8FF") +
annotate(geom = "rect", xmin = 6.5, xmax = 8.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#4E79A7FF") +
annotate(geom = "rect", xmin = 8.5, xmax = 11.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#FFBE7DFF") +
annotate(geom = "rect", xmin = 11.5, xmax = 14.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#F28E2BFF") +
annotate(geom = "rect", xmin = 14.5, xmax = 17.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#8CD17DFF") +
annotate(geom = "rect", xmin = 17.5, xmax = 19.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#59A14FFF") +
annotate(geom = "rect", xmin = 19.5, xmax = 21.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#D7B5A6FF") +
annotate(geom = "rect", xmin = 21.5, xmax = 23.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#9D7660FF") +
annotate(geom = "rect", xmin = 23.5, xmax = 25.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#FABFD2FF") +
annotate(geom = "rect", xmin = 25.5, xmax = 27.5, ymin = -0.5, ymax = 0.2, alpha = 1, fill = "#D37295FF")
#### Table with confidence intervals ####
dat_table <- dat %>%
mutate(
lower = estimate - 1.96*std.error,
upper = estimate + 1.96*std.error,
beta_ci = sprintf("%0.2f\n[%0.2f, %0.2f]", estimate, lower, upper),
beta_ci = case_when(
is.na(estimate) ~ NA,
!is.na(estimate) & p.value >= 0.05 ~ beta_ci,
!is.na(estimate) & p.value < 0.05 ~ str_c(beta_ci, p.sig),
TRUE ~ NA_character_
)
) %>%
select(country, subgroup, beta_ci) %>%
pivot_wider(names_from = subgroup, values_from = beta_ci)
write_csv(dat_table, str_c(getwd(), "/results/Table/Supplementary Table 7_Subgroup effect sizes (CI) for life satisfaction.csv"))
dat_legend <- dat %>%
mutate(
category = case_when(
subgroup %in% c("50-64 years", "≥65 years") ~ "age",
subgroup %in% c("Male", "Female") ~ "gender",
subgroup %in% c("Married", "Unmarried") ~ "marital",
subgroup %in% c("Weekly contact", "Less than weekly contact") ~ "contact",
subgroup %in% c("Primary", "Secondary", "Tertiary") ~ "edu",
subgroup %in% c("Low", "Middle", "High") ~ "wealth",
subgroup %in% c("Working", "Retired", "Others") ~ "lbrf",
subgroup %in% c("Current smoking", "No smoking") ~ "smoke",
subgroup %in% c("Weekly alcohol use", "Less than weekly alcohol use") ~ "drink",
subgroup %in% c("Physical activity", "Physical inactivity") ~ "phyact",
subgroup %in% c("No chronic conditions", "≥1 chronic condition") ~ "disease",
subgroup %in% c("No ADL limitation", "ADL disability") ~ "disability",
subgroup %in% c("Low genetic risk (DS)", "Intermediate genetic risk (DS)", "High genetic risk (DS)") ~ "dpgs",
subgroup %in% c("Low genetic risk (SWB)", "Intermediate genetic risk (SWB)", "High genetic risk (SWB)") ~ "wpgs",
TRUE ~ NA_character_
),
category = factor(category, levels = c("age", "gender", "marital", "contact", "edu", "wealth", "lbrf", "smoke", "drink", "phyact", "disease", "disability", "dpgs", "wpgs"), labels = c("Age", "Gender", "Marital status", "Contact with others", "Education", "Household wealth", "Labor force status", "Current smoking", "Alcohol consumption", "Physical activity status", "ADL disability", "Chronic conditions", "Depressive symptoms PGS", "Subjective well-being PGS"))
)
legend_1 <- ggplot(dat_legend, aes(x = category, y = estimate, fill = category)) +
geom_bar(stat = "identity") +
scale_fill_manual(
values = c("#FF9D9AFF", "#E15759FF", "#A0CBE8FF", "#4E79A7FF", "#FFBE7DFF", "#F28E2BFF", "#8CD17DFF", "#59A14FFF", "#D7B5A6FF", "#9D7660FF", "#FABFD2FF", "#D37295FF", "#F1CE63FF", "#B6992DFF"),
) +
guides(fill = guide_legend(byrow = T)) +
theme(
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.position = "right",
legend.key.size = unit(1.5, "lines")
)
legend_2 <- ggplot(dat, aes(x = subgroup, y = country_italic, fill = estimate_new)) +
geom_tile(colour = "grey50") +
theme_void() +
theme(
legend.position = "right"
) +
scale_fill_gradientn(
colours = c("#58539f", "#bbbbd6", "#FFFFFFFF", "#eebabb", "#d86967"),
limit = c(-0.5, 0.5),
breaks = c(-0.5, -0.25, 0, 0.25, 0.5),
labels = c("<-0.5", -0.25, 0, 0.25, ">0.5"),
name = "AME"
) +
labs(
x = NULL,
y = NULL,
title = NULL
) &
guides(fill =
guide_colourbar(
barwidth = unit(0.3, "in"), barheight = unit(3, "in"),
label.theme = element_text(size = 16, colour = "black", angle = 0),
title.theme = element_text(size = 16, colour = "black", angle = 0, hjust = 0.1)
)
)
rect_pool <- wrap_elements(
wrap_elements(rect_cesd) + wrap_elements(rect_satlife) +
plot_layout(nrow = 2, heights = c(0.75, 1)) &
plot_annotation(tag_levels = "a")
)
design <- "
AAAAAAAAAA##
AAAAAAAAAABB
AAAAAAAAAABB
AAAAAAAAAAC#
AAAAAAAAAAC#
AAAAAAAAAA##
"
heatmap_pool <- wrap_plots(
rect_pool, wrap_elements(get_legend(legend_1)), wrap_elements(get_legend(legend_2)),
design = design
)
ggsave(str_c(getwd(), "/results/Figure/Figure 2_Heatmap.tiff"), plot = heatmap_pool, width = 20, height = 18, unit = "in", dpi = 300, device = "tiff")
ggsave(str_c(getwd(), "/results/Figure/Figure 2_Heatmap.pdf"), plot = heatmap_pool, width = 20, height = 18, unit = "in", dpi = 300, device = "pdf")
satlife_iyes_adj_mi_deprepgs_low_hrs
satlife_iyes_adj_mi_deprepgs_re_hrs
satlife_iyes_adj_mi_deprepgs_re_elsa
shlt_iyes_adj_mi_deprepgs_re_hrs
shlt_iyes_adj_mi_deprepgs_re_elsa
citation()
load("E:/Multiple cohort study/Harmonized Data FIile/HarmonizedSurveyData/internet_use_mental/internet-use-mental-health/data/analysis_20240801_correction.RData")
knitr::opts_chunk$set(echo = TRUE)
# Make sure the working directory is "your path/internet-use-mental-health"
knitr::opts_knit$set(root.dir = "E:/Multiple cohort study/Harmonized Data FIile/HarmonizedSurveyData/internet_use_mental/internet-use-mental-health")
# data processing
library(tidyverse)
library(readxl)
library(skimr)
library(mice)
library(miceadds)
library(gtsummary)
library(glue)
library(gt)
library(tictoc)
library(data.table)
library(modelsummary)
library(broom.mixed)
# visualization
library(forestploter)
library(ggplot2)
library(ggpubr)
library(ggtext)
library(patchwork)
library(grid)
library(glue)
library(ggsci)
# statistical analysis
library(lmerTest)
library(metafor)
library(marginaleffects)
library(survival)
library(gfoRmula)
library(geepack)
dat_hrs <- lapply(mi_iyes_pgs_hrs, as.data.table) %>%
lapply(., as.data.frame) %>%
miceadds::datlist2mids()
dat_hrs
mi_iyes_pgs_elsa
dat_elsa <- lapply(mi_iyes_pgs_elsa, as.data.table) %>%
lapply(., as.data.frame) %>%
miceadds::datlist2mids()
#### CES-D ####
# HRS
cesd_iyes_adj_deprepgs <- with(dat_hrs, lmer(
cesd_stand  ~ internet_yes*cwave + highdeprepgs +
age + male + lowedu + lowwealth + lbrf +
nonmarried + hhres + smoken + weekdrink + phyinact +
dis + adl_any + iadl +
(1 | id), control = lmerControl(optimizer = "bobyqa")))
cesd_iyes_adj_deprepgs_int <- with(dat_hrs, lmer(
cesd_stand  ~ internet_yes*cwave + internet_yes*highdeprepgs +
age + male + lowedu + lowwealth + lbrf +
nonmarried + hhres + smoken + weekdrink + phyinact +
dis + adl_any + iadl +
(1 | id), control = lmerControl(optimizer = "bobyqa")))
cesd_iyes_adj_mi_dis_results
cesd_iyes_adj_mi_nodis_results
#### CES-D ####
cesd_iyes_adj_mi_disall_results <- cesd_iyes_adj_mi_dis_results %>%
mutate(subgroup = "dis") %>%
bind_rows(., cesd_iyes_adj_mi_nodis_results %>% mutate(subgroup = "nodis"))
cesd_iyes_adj_mi_disall_meta <- rma(yi = estimate, sei = std.error, mods = ~ subgroup, data = cesd_iyes_adj_mi_disall_results, slab = country)
cesd_iyes_adj_mi_disall_meta
